<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>YardSale: ys_inventory.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>ys_inventory.cpp</h1><div class="fragment"><pre>00001 <span class="preprocessor">#include "wx/app.h"</span>
00002 <span class="preprocessor">#include "wx/wx.h"</span>
00003 <span class="preprocessor">#include "wx/treectrl.h"</span>
00004 <span class="preprocessor">#include "wx/spinctrl.h"</span>
00005 
00006 <span class="preprocessor">#include &lt;sstream&gt;</span>
00007 <span class="preprocessor">#include &lt;vector&gt;</span>
00008 
00009 <span class="preprocessor">#include "yardsale.h"</span>
00010 <span class="preprocessor">#include "ys_log.h"</span>
00011 <span class="preprocessor">#include "ys_util.h"</span>
00012 <span class="preprocessor">#include "ys_database.h"</span>
00013 <span class="preprocessor">#include "ys_exception.h"</span>
00014 <span class="preprocessor">#include "ys_inventory.h"</span>
00015 <span class="preprocessor">#include "ys_inv_type.h"</span>
00016 <span class="preprocessor">#include "ys_generic.h"</span>
00017 <span class="preprocessor">#include "ys_new_item.h"</span>
00018 
00019 <span class="preprocessor">#include "extra/xrc/xmlres.h"</span>
00020 
00021 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00022 
00023 BEGIN_EVENT_TABLE(<a class="code" href="class_yard_inventory.html">YardInventory</a>, wxDialog)
00024     EVT_TREE_SEL_CHANGED(XRCID(<span class="stringliteral">"ID_INV_TREE"</span>), YardInventory::OnChange)
00025     EVT_BUTTON(XRCID(<span class="stringliteral">"ID_INV_NEW"</span>), YardInventory::OnNew)
00026     EVT_BUTTON(XRCID(<span class="stringliteral">"ID_INV_SEARCH"</span>), YardInventory::OnSearch)
00027     EVT_BUTTON(XRCID(<span class="stringliteral">"ID_INV_LEAVE"</span>), YardInventory::OnExitButton)
00028     EVT_BUTTON(XRCID(<span class="stringliteral">"ID_INV_EDIT_VENDOR"</span>), YardInventory::OnEditVendor)
00029     EVT_BUTTON(XRCID(<span class="stringliteral">"ID_INV_EDIT_DEPTS"</span>), YardInventory::OnEditDepts)
00030     EVT_BUTTON(XRCID(<span class="stringliteral">"ID_INV_EDIT_GROUPS"</span>), YardInventory::OnEditGroups)
00031     EVT_BUTTON(XRCID(<span class="stringliteral">"ID_INV_TAX_EDIT"</span>), YardInventory::OnEditTax)
00032     EVT_LIST_ITEM_SELECTED(XRCID(<span class="stringliteral">"ID_INV_LIST"</span>), YardInventory::OnSelect)
00033 END_EVENT_TABLE()
00034 
00035 DECLARE_APP(<a class="code" href="class_yard_sale.html">YardSale</a>)
00036 
00037 <span class="keyword">class </span>invItemData: <span class="keyword">public</span> wxTreeItemData
00038 {
00039  <span class="keyword">public</span>:
00040     invItemData(<span class="keywordtype">long</span> id): 
00041         wxTreeItemData(), m_id(id) {}
00042     ~invItemData() {}
00043     
00044     <span class="keyword">const</span> <span class="keywordtype">long</span> GetID() { <span class="keywordflow">return</span> m_id; }
00045 
00046  <span class="keyword">private</span>:
00047     <span class="keywordtype">long</span> m_id;  
00048 };
00049 
<a name="l00050"></a><a class="code" href="class_yard_inventory.html#a0">00050</a> <a class="code" href="class_yard_inventory.html#a0">YardInventory::YardInventory</a>(wxWindow* parent, wxWindowID id, <span class="keyword">const</span> wxString&amp; title,
00051                    <span class="keyword">const</span> wxPoint&amp; pos, <span class="keyword">const</span> wxSize&amp; size, <span class="keywordtype">long</span> style, <span class="keyword">const</span> wxString&amp; name)
00052 :wxDialog(parent, id, title, pos, size, style, name) {
00053      
00054     wxBusyCursor busy();
00055     wxXmlResource::Get()-&gt;Load(<span class="stringliteral">"res/new_inv.xrc"</span>);
00056     wxPanel * panel = wxXmlResource::Get()-&gt;LoadPanel(<span class="keyword">this</span>, <span class="stringliteral">"ItemDisplay"</span>);
00057     wxSizer * sizer = panel-&gt;GetSizer();
00058     sizer-&gt;SetSizeHints(<span class="keyword">this</span>);
00059     SetSize(sizer-&gt;GetMinSize());
00060     SetSize(wxSize(600,400));
00061     Centre();  
00062 
00063    
00064     <span class="comment">// set the window components </span>
00065     
00066     SetPointers();
00067     LoadTreeItems(m_tree);
00068     
00069 }
00070 
<a name="l00071"></a><a class="code" href="class_yard_inventory.html#a1">00071</a> <a class="code" href="class_yard_inventory.html#a1">YardInventory::~YardInventory</a>()
00072 {
00073     
00074 }
00075 
00076 <span class="keywordtype">void</span> YardInventory::PopulateList()
00077 {
00078 <span class="preprocessor">    #if 0</span>
00079 <span class="preprocessor"></span>    m_list-&gt;DeleteAllItems();
00080     
00081     wxLogDebug(wxT(<span class="stringliteral">"Populating list"</span>));
00082     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m_objects.size(); i++)
00083     {       
00084         m_list-&gt;InsertItem(0, m_objects[i].GetSKU().c_str());
00085         m_list-&gt;SetItem(0,1, m_objects[i].GetBarCode().c_str());
00086         m_list-&gt;SetItem(0,2, m_objects[i].GetDescription().c_str());
00087         m_list-&gt;SetItem(0,3, m_objects[i].GetDepartment().c_str());
00088         m_list-&gt;SetItem(0,4, m_objects[i].GetQuantOnHandS().c_str());
00089         m_list-&gt;SetItem(0,5, m_objects[i].GetRetailPriceS().c_str());
00090         m_list-&gt;SetItem(0,6, m_objects[i].GetWholesalePriceS().c_str());
00091     }
00092     
00093     m_list-&gt;SetColumnWidth( 0, wxLIST_AUTOSIZE );
00094     m_list-&gt;SetColumnWidth( 1, wxLIST_AUTOSIZE );
00095     m_list-&gt;SetColumnWidth( 2, wxLIST_AUTOSIZE );
00096     m_list-&gt;SetColumnWidth( 3, wxLIST_AUTOSIZE );
00097     m_list-&gt;SetColumnWidth( 4, wxLIST_AUTOSIZE );
00098     m_list-&gt;SetColumnWidth( 5, wxLIST_AUTOSIZE );
00099     m_list-&gt;SetColumnWidth( 6, wxLIST_AUTOSIZE );
00100 <span class="preprocessor">    #endif</span>
00101 <span class="preprocessor"></span>}
00102 
00103 <span class="keywordtype">void</span> YardInventory::SetPointers()
00104 {
00105 
00106     m_tree = static_cast&lt;wxTreeCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_TREE"</span>)));
00107     
00108     <span class="comment">// details</span>
00109     m_det_sku = static_cast&lt;wxTextCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_SKU"</span>)));
00110     m_det_name = static_cast&lt;wxTextCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_ITEMNAME"</span>)));
00111     m_det_desc = static_cast&lt;wxTextCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_DESC"</span>)));
00112     m_det_barcode = static_cast&lt;wxTextCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_BARCODE"</span>)));
00113     m_det_dept = static_cast&lt;wxComboBox *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_DEPARTMENT"</span>)));
00114     <span class="comment">//m_dep_dept_edit = static_cast&lt;wxBitmapButton *&gt;(FindWindow(XRCID("ID_INV_EDIT_DEPTS")));</span>
00115     m_dep_group = static_cast&lt;wxComboBox *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_GROUP"</span>)));
00116     <span class="comment">//m_dep_group_edit = static_cast&lt;wxBitmapButton *&gt;(FindWindow(XRCID("ID_INV_EDIT_GROUPS")));</span>
00117     m_dep_image = static_cast&lt;wxStaticBitmap *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_IMAGE"</span>)));
00118     m_dep_vendor = static_cast&lt;wxComboBox *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_VENDOR"</span>)));
00119     <span class="comment">//m_dep_vendor_edit = static_cast&lt;wxBitmapButton *&gt;(FindWindow(XRCID("ID_INV_EDIT_VENDOR")));</span>
00120     
00121     <span class="comment">// pricing</span>
00122     m_price_retail = static_cast&lt;wxTextCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_PRICE"</span>)));
00123     m_price_wholesale = static_cast&lt;wxTextCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_WHOLESALE"</span>)));
00124     m_price_bulk = static_cast&lt;wxListCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_BULK_TALBE"</span>)));
00125     <span class="comment">//m_price_bulk_add = static_cast&lt;wxButton *&gt;(FindWindow(XRCID("ID_INV_ADD_BULK")));</span>
00126     <span class="comment">//m_price_bulk_rm = static_cast&lt;wxButton *&gt;(FindWindow(XRCID("ID_INV_REMOVE_BULK")));</span>
00127     m_price_tax = static_cast&lt;wxComboBox *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_TAX"</span>)));
00128     <span class="comment">//m_price_tax_edit = static_cast&lt;wxBitmapButton *&gt;(FindWindow(XRCID("ID_INV_TAX_EDIT")));</span>
00129     
00130     m_ship_weight = static_cast&lt;wxTextCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_ITEM_WEIGHT"</span>)));
00131     m_ship_date_rec = static_cast&lt;wxTextCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_DATE_RECEIVED"</span>)));
00132     m_ship_oversized = static_cast&lt;wxCheckBox *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_OVERSIZED"</span>)));
00133     m_ship_freight = static_cast&lt;wxCheckBox *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_FREIGHT_ONLY"</span>)));
00134     
00135     m_stock_onhand = static_cast&lt;wxSpinCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_ON_HAND"</span>)));
00136     m_stock_onorder = static_cast&lt;wxSpinCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_ON_ORDER"</span>)));
00137     m_stock_reorder_lvl = static_cast&lt;wxSpinCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_INV_REORDER_LEVEL"</span>)));
00138     m_stock_reorder_quant = static_cast&lt;wxSpinCtrl *&gt;(FindWindow(XRCID(<span class="stringliteral">"ID_REORDER_QUANT"</span>)));
00139 
00140 }
00141 
<a name="l00142"></a><a class="code" href="class_yard_inventory.html#a6">00142</a> <span class="keywordtype">void</span> <a class="code" href="class_yard_inventory.html#a6">YardInventory::OnEditVendor</a>(wxCommandEvent&amp; event)
00143 {
00145     vector&lt;YardVendType&gt; vends; 
00146     <span class="keywordflow">try</span> {
00147         vends = wxGetApp().DB().VendorGetAll();
00148     }
00149     <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00150     {
00151         wxLogDebug(wxT(<span class="stringliteral">"Error (vend load): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00152         <span class="keywordflow">return</span>;
00153     }
00154     YardGenericEdit&lt;YardVendType&gt; * myEdit = <span class="keyword">new</span> YardGenericEdit&lt;YardVendType&gt;(<span class="keyword">this</span>, -1, wxT(<span class="stringliteral">"Vendor Edit"</span>));
00155     myEdit-&gt;SetObjects(vends);
00156     myEdit-&gt;ShowModal();
00157     myEdit-&gt;Destroy();
00158 }
00159 
00160 <span class="keywordtype">void</span> YardInventory::OnEditDepts(wxCommandEvent&amp; event)
00161 {
00162     wxLogDebug(wxT(<span class="stringliteral">"No departments in db"</span>));
00163     
00164 }
00165 
00166 <span class="keywordtype">void</span> YardInventory::OnEditGroups(wxCommandEvent&amp; event)
00167 {
00168     vector&lt;YardGroup&gt; grps; 
00169     <span class="keywordflow">try</span> {
00170         grps = wxGetApp().DB().GroupGetAll();
00171     }
00172     <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00173     {
00174         wxLogDebug(wxT(<span class="stringliteral">"Error (grp load): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00175         <span class="keywordflow">return</span>;
00176     }
00177     YardGenericEdit&lt;YardGroup&gt; * myEdit = <span class="keyword">new</span> YardGenericEdit&lt;YardGroup&gt;(<span class="keyword">this</span>, -1, wxT(<span class="stringliteral">"Group Edit"</span>));
00178     myEdit-&gt;SetObjects(grps);
00179     myEdit-&gt;ShowModal();
00180     myEdit-&gt;Destroy();
00181     
00182 }
00183 
00184 <span class="keywordtype">void</span> YardInventory::OnEditTax(wxCommandEvent&amp; event)
00185 {
00186     vector&lt;YardTaxType&gt; taxes; 
00187     <span class="keywordflow">try</span> {
00188         taxes = wxGetApp().DB().TaxTypeGetAll();
00189     }
00190     <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00191     {
00192         wxLogDebug(wxT(<span class="stringliteral">"Error (tax load): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00193         <span class="keywordflow">return</span>;
00194     }
00195     YardGenericEdit&lt;YardTaxType&gt; * myEdit = <span class="keyword">new</span> YardGenericEdit&lt;YardTaxType&gt;(<span class="keyword">this</span>, -1, wxT(<span class="stringliteral">"Tax Edit"</span>));
00196     myEdit-&gt;SetObjects(taxes);
00197     myEdit-&gt;ShowModal();
00198     myEdit-&gt;Destroy();
00199     
00200 }
00201 
<a name="l00202"></a><a class="code" href="class_yard_inventory.html#a2">00202</a> <span class="keywordtype">void</span> <a class="code" href="class_yard_inventory.html#a2">YardInventory::OnExitButton</a>(wxCommandEvent &amp; event)
00203 {
00204     wxLogDebug(<span class="stringliteral">"OnExit"</span>);
00205     EndModal(0);
00206 
00207 }
00208 
<a name="l00209"></a><a class="code" href="class_yard_inventory.html#a3">00209</a> <span class="keywordtype">void</span> <a class="code" href="class_yard_inventory.html#a3">YardInventory::OnNew</a>(wxCommandEvent &amp; event) {
00210     wxLogDebug(wxT(<span class="stringliteral">"OnNew"</span>));
00211     
00212     wxBitmap logo(<span class="stringliteral">"res/ys_inventory_128x128.png"</span>, wxBITMAP_TYPE_PNG);
00213     YardNewItem * wizard = <span class="keyword">new</span> YardNewItem(<span class="keyword">this</span>, -1, 
00214         wxT(<span class="stringliteral">"New Item Wizard"</span>), logo);
00215     
00216     YardNewItem1 * page1 = <span class="keyword">new</span> YardNewItem1(wizard);
00217     YardNewItem2 * page2 = <span class="keyword">new</span> YardNewItem2(wizard);
00218     YardNewItem3 * page3 = <span class="keyword">new</span> YardNewItem3(wizard);
00219     YardNewItem4 * page4 = <span class="keyword">new</span> YardNewItem4(wizard);
00220     
00221     wxWizardPageSimple::Chain(page1, page2);
00222     wxWizardPageSimple::Chain(page2, page3);
00223     wxWizardPageSimple::Chain(page3, page4);
00224     
00225     wxSize min = page4-&gt;GetMin();
00226     wizard-&gt;SetPageSize(min);
00227 
00228     <span class="keywordflow">if</span> ( wizard-&gt;RunWizard(page1) )
00229     {
00230         wxLogDebug(wxT(<span class="stringliteral">"Wizard completed OK"</span>));
00231         
00232         <a class="code" href="class_yard_inv_type.html">YardInvType</a> temp = wizard-&gt;GetItem();
00233         
00234         <span class="keywordflow">try</span> {
00235             wxGetApp().DB().InventoryAdd(temp);
00236         }
00237         <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00238         {
00239             wxLogDebug(wxT(<span class="stringliteral">"Error (inv not added): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00240         }
00241     }
00242     wizard-&gt;Destroy();
00243 }
00244 
00245 <span class="keywordtype">void</span> YardInventory::LoadFromDB() {
00246 <span class="preprocessor">    #if 0</span>
00247 <span class="preprocessor"></span>     <span class="comment">// Getting initial list of items</span>
00248     <span class="keywordflow">if</span> (wxGetApp().DB().IsConnected())
00249     {
00250         wxLogDebug(wxT(<span class="stringliteral">"Connected"</span>));
00251         
00252         <span class="keywordflow">try</span> {
00253             m_objects = wxGetApp().DB().InventoryGetAll();
00254         }
00255         <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a> &amp;e)
00256         {
00257             wxLogDB(e.GetWhat().c_str());
00258             wxLogDB(e.GetVarInfo().c_str());
00259             wxLogSQL(e.GetSQL().c_str());
00260             <span class="keywordflow">return</span>;
00261         }
00262         <span class="comment">// showing list to screen</span>
00263        
00264     }
00265     <span class="keywordflow">else</span>
00266         wxLogError(wxT(<span class="stringliteral">"Not Connected"</span>));
00267 <span class="preprocessor">    #endif</span>
00268 <span class="preprocessor"></span>}
00269 
00270 
<a name="l00271"></a><a class="code" href="class_yard_inventory.html#a4">00271</a> <span class="keywordtype">void</span> <a class="code" href="class_yard_inventory.html#a4">YardInventory::OnSearch</a>(wxCommandEvent &amp; event){
00272 
00273 }
00274 
<a name="l00275"></a><a class="code" href="class_yard_inventory.html#a5">00275</a> <span class="keywordtype">void</span> <a class="code" href="class_yard_inventory.html#a5">YardInventory::OnSelect</a>(wxListEvent &amp; event){
00276 <span class="preprocessor">#if 0</span>
00277 <span class="preprocessor"></span>    <span class="keywordtype">long</span> index = event.GetIndex();
00278     
00279     <span class="keywordflow">if</span> (index &gt;= m_objects.size() || (index &lt; 0))
00280     {
00281         wxLogDebug(wxT(<span class="stringliteral">"Invalid index"</span>));
00282         <span class="keywordflow">return</span>;
00283     }
00284 
00285     m_sku-&gt;SetValue(m_objects[index].GetSKU().c_str());
00286     m_barCode-&gt;SetValue(m_objects[index].GetBarCode().c_str());
00287     m_name-&gt;SetValue(m_objects[index].GetType().c_str());
00288     m_department-&gt;SetValue(m_objects[index].GetDepartment().c_str());
00289     m_type-&gt;SetValue(m_objects[index].GetType().c_str());
00290     
00291     m_price-&gt;SetValue(m_objects[index].GetRetailPriceS().c_str());
00292     m_wholesale-&gt;SetValue(m_objects[index].GetWholesalePriceS().c_str());
00293     m_weight-&gt;SetValue(m_objects[index].GetWeightLbsS().c_str());
00294     m_desc-&gt;SetValue(m_objects[index].GetDescription().c_str());
00295 <span class="preprocessor">    #endif</span>
00296 <span class="preprocessor"></span>}
00297 
00298 <span class="keywordtype">void</span> YardInventory::LoadTreeItems(wxTreeCtrl * tree)
00299 {
00300     tree-&gt;AddRoot(wxT(<span class="stringliteral">"Root"</span>));
00301     tree-&gt;SetIndent(10);
00302     tree-&gt;SetSpacing(5);
00303     <span class="comment">// load groups first</span>
00304     
00305     vector&lt;YardGroup&gt; groups;
00306     
00307     <span class="keywordflow">try</span> {
00308         groups = wxGetApp().DB().GroupGetAll();
00309     }
00310     <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00311     {
00312         wxLogDebug(wxT(<span class="stringliteral">"Error (grp load): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00313         <span class="keywordflow">return</span>;
00314     }
00315     
00316     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; groups.size(); i++)
00317     {
00318         wxTreeItemId groupid = tree-&gt;AppendItem(tree-&gt;GetRootItem(),
00319             groups[i].GetName().c_str(), -1,-1, <span class="keyword">new</span> invItemData(-1));
00320         
00321         vector&lt;YardInvType&gt; items;
00322         <span class="keywordflow">try</span> {
00323             items = wxGetApp().DB().InventoryGetInGroup(groups[i].GetId());
00324         }
00325         <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)            
00326         {
00327             wxLogDebug(wxT(<span class="stringliteral">"Error (item load): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00328             <span class="keywordflow">return</span>;
00329         }
00330         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; items.size(); k++)
00331         {
00332             <span class="keywordtype">int</span> img = -1; <span class="comment">//items[k].GetGroupId() %  4;</span>
00333             tree-&gt;AppendItem(groupid, items[k].GetName().c_str(), img, img,
00334                 <span class="keyword">new</span> invItemData(items[k].GetKey()));
00335         }
00336     }
00337     
00338     <span class="comment">// load in vendors, taxes, departments</span>
00339     vector&lt;YardVendType&gt; vends; 
00340     <span class="keywordflow">try</span> {
00341         vends = wxGetApp().DB().VendorGetAll();
00342     }
00343     <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00344     {
00345         wxLogDebug(wxT(<span class="stringliteral">"Error (vend load): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00346         <span class="keywordflow">return</span>;
00347     }
00348     
00349     vector&lt;YardCarrierType&gt; carrier;
00350     <span class="keywordflow">try</span> {
00351         carrier = wxGetApp().DB().CarrierGetAll();
00352     }
00353     <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00354     {
00355         wxLogDebug(wxT(<span class="stringliteral">"Error (carr load): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00356         <span class="keywordflow">return</span>;
00357     }
00358     
00359     vector&lt;YardTaxType&gt; tax;
00360     <span class="keywordflow">try</span> {
00361         tax = wxGetApp().DB().TaxTypeGetAll();
00362     }
00363     <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00364     {
00365         wxLogDebug(wxT(<span class="stringliteral">"Error (tax load): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00366         <span class="keywordflow">return</span>;
00367     }
00368     
00369     <span class="comment">//wxComboBox * m_dep_group;</span>
00370     m_dep_group-&gt;Clear();
00371     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; groups.size(); i++)
00372     {
00373         m_dep_group-&gt;Append(groups[i].GetName().c_str(), (<span class="keywordtype">void</span>*)groups[i].GetId());
00374     }
00375    <span class="comment">// wxComboBox * m_price_tax;</span>
00376     m_price_tax-&gt;Clear();
00377     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; tax.size(); i++)
00378     {
00379         m_price_tax-&gt;Append(tax[i].GetName().c_str(), (<span class="keywordtype">void</span>*)tax[i].GetId());
00380     }
00381     <span class="comment">//wxComboBox * m_det_dept-&gt;;</span>
00382     
00383     <span class="comment">//wxComboBox * m_dep_vendor;</span>
00384     m_dep_vendor-&gt;Clear();
00385     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; vends.size(); i++)
00386     {
00387         m_dep_vendor-&gt;Append(vends[i].GetName().c_str(), (<span class="keywordtype">void</span>*)vends[i].GetId());
00388     }
00389 
00390 }
00391 
00392 <span class="keywordtype">void</span> YardInventory::OnChange(wxTreeEvent&amp; event)
00393 {
00394     invItemData * data = static_cast&lt;invItemData *&gt;(m_tree-&gt;GetItemData(event.GetItem()));
00395 
00396     <span class="keywordflow">if</span> (!data)
00397         <span class="keywordflow">return</span>;
00398     
00399     <span class="keywordflow">if</span> (data-&gt;GetID() == -1)
00400     {
00401         <span class="keywordflow">return</span>;
00402     }
00403     
00404     <a class="code" href="class_yard_inv_type.html">YardInvType</a> temp;
00405     <span class="keywordflow">try</span> {
00406         temp = wxGetApp().DB().InventoryGet(data-&gt;GetID());
00407     }
00408     <span class="keywordflow">catch</span> (<a class="code" href="class_yard_d_b_exception.html">YardDBException</a>&amp; e)
00409     {
00410         wxLogDebug(wxT(<span class="stringliteral">"Error (item not loaded): %s, %s"</span>),e.what(), e.GetSQL().c_str());
00411         <span class="keywordflow">return</span>;
00412     }
00413     
00414     <span class="comment">//</span>
00415     ShowItem(temp);
00416    
00417 }
00418 
00419 <span class="keywordtype">void</span> YardInventory::ShowItem(<span class="keyword">const</span> <a class="code" href="class_yard_inv_type.html">YardInvType</a>&amp; item)
00420 {
00421     
00422     m_det_sku-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a4">GetSKU</a>().c_str());
00423     m_det_name-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a5">GetName</a>().c_str());
00424     m_det_desc-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a7">GetDescription</a>().c_str());
00425     m_det_barcode-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a6">GetBarCode</a>().c_str());
00426    
00427     <span class="comment">//wxStaticBitmap * m_dep_image;</span>
00428     
00429     <span class="comment">// pricing</span>
00430     m_price_retail-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a24">GetRetailPriceS</a>().c_str());
00431     m_price_wholesale-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a26">GetWholesalePriceS</a>().c_str());
00432     <span class="comment">//wxListCtrl * m_price_bulk;</span>
00433     
00434     m_ship_weight-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a18">GetWeightLbsS</a>().c_str());
00435     m_ship_date_rec-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a37">GetDateLastReceived</a>().ToString().c_str());
00436     m_ship_oversized-&gt;SetValue((item.<a class="code" href="class_yard_inv_type.html#a29">IsOverSized</a>()) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
00437     m_ship_freight-&gt;SetValue((item.<a class="code" href="class_yard_inv_type.html#a31">MustShipFreight</a>()) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
00438     
00439     m_stock_onhand-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a10">GetQuantOnHand</a>());
00440     m_stock_onorder-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a12">GetQuantOnOrder</a>());
00441     m_stock_reorder_lvl-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a14">GetReorderLevel</a>());
00442     m_stock_reorder_quant-&gt;SetValue(item.<a class="code" href="class_yard_inv_type.html#a16">GetReorderQuantity</a>());
00443     
00444 }
00445 
00446 <a class="code" href="class_yard_inv_type.html">YardInvType</a> YardInventory::SaveItem()  
00447 {
00448     
00449 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun May 9 23:07:59 2004 for YardSale by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
