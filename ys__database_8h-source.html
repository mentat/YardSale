<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>YardSale: ys_database.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>ys_database.h</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">    YardSale - The Open Point of Sale</span>
00003 <span class="comment">    Copyright (C) 2004 - Jesse Lovelace &lt;jllovela@ncsu.edu&gt;</span>
00004 <span class="comment"> </span>
00005 <span class="comment">    This program is free software; you can redistribute it and/or modify</span>
00006 <span class="comment">    it under the terms of the GNU General Public License as published by</span>
00007 <span class="comment">    the Free Software Foundation; either version 2 of the License, or</span>
00008 <span class="comment">    (at your option) any later version.</span>
00009 <span class="comment"></span>
00010 <span class="comment">    This program is distributed in the hope that it will be useful,</span>
00011 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00012 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00013 <span class="comment">    GNU General Public License for more details.</span>
00014 <span class="comment"></span>
00015 <span class="comment">    You should have received a copy of the GNU General Public License</span>
00016 <span class="comment">    along with this program; if not, write to the Free Software</span>
00017 <span class="comment">    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00018 <span class="comment">*/</span>
00019 <span class="preprocessor">#ifndef YS_DATABASE_H</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#define YS_DATABASE_H</span>
00021 <span class="preprocessor"></span>
00022 <span class="preprocessor">#include "ys_exception.h"</span>
00023 <span class="preprocessor">#include &lt;vector&gt;</span>
00024 <span class="preprocessor">#include &lt;map&gt;</span>
00025 <span class="preprocessor">#include &lt;string&gt;</span>
00026 
00027 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00028 
00029 <span class="comment">// Forward declarations for speed -jll</span>
00030 <span class="preprocessor">#include "ys_group.h"</span>
00031 <span class="preprocessor">#include "ys_inv_type.h"</span>
00032 <span class="preprocessor">#include "ys_trans_type.h"</span>
00033 <span class="preprocessor">#include "ys_employee_type.h"</span>
00034 <span class="preprocessor">#include "ys_cust_type.h"</span>
00035 <span class="preprocessor">#include "ys_vend_type.h"</span>
00036 <span class="preprocessor">#include "ys_trans_type.h"</span>
00037 <span class="preprocessor">#include "ys_package_type.h"</span>
00038 <span class="preprocessor">#include "ys_shipping_type.h"</span>
00039 <span class="preprocessor">#include "ys_carrier_type.h"</span>
00040 <span class="preprocessor">#include "ys_tax_type.h"</span>
00041     
00042 <span class="keyword">class </span>otl_connect;
00043 <span class="keyword">class </span>otl_stream;
00044 
<a name="l00057"></a><a class="code" href="class_yard_database.html">00057</a> <span class="keyword">class </span><a class="code" href="class_yard_database.html">YardDatabase</a> {
00058     <span class="keyword">public</span>:
00059     
00066     <a class="code" href="class_yard_database.html#a1">YardDatabase</a>(<span class="keyword">const</span> string&amp; name, <span class="keyword">const</span> string&amp; pass, <span class="keyword">const</span> string&amp; dsn);
00067     <span class="comment">//YardDatabase(const YardDBConfig&amp; config);  </span>
00068     
00072     <a class="code" href="class_yard_database.html#a1">YardDatabase</a>();
00073 
00080     <span class="keywordtype">bool</span> <a class="code" href="class_yard_database.html#a2">Init</a>(<span class="keyword">const</span> string&amp; name, <span class="keyword">const</span> string&amp; pass, <span class="keyword">const</span> string&amp; dsn);
00081     
00083     <a class="code" href="class_yard_database.html#a3">~YardDatabase</a>();
00084     
00091     <span class="keywordtype">bool</span> <a class="code" href="class_yard_database.html#a4">connect</a>();
00092     
00098     <span class="keywordtype">bool</span> <a class="code" href="class_yard_database.html#a5">disconnect</a>();
00099      
00104     <span class="keywordtype">int</span> <a class="code" href="class_yard_database.html#a6">GetStatus</a>() <span class="keyword">const</span>;
00105      
00106 
00107     <span class="keywordtype">bool</span> IsConnected() <span class="keyword">const</span>;
00108 
00109     <span class="comment">/*------------Inventory-------------*/</span>
00110     
00119     vector&lt;YardInvType&gt; <a class="code" href="class_yard_database.html#a8">InventorySearchSKU</a>(<span class="keyword">const</span> string&amp; sku);
00120     
00121     <a class="code" href="class_yard_inv_type.html">YardInvType</a> <a class="code" href="class_yard_database.html#a9">InventoryBarcode</a>(<span class="keyword">const</span> string&amp; barcode) <span class="keyword">const</span>;
00122     
00128     vector&lt;YardInvType&gt; <a class="code" href="class_yard_database.html#a10">InventoryGetAll</a>() <span class="keyword">const</span>;
00131     vector&lt;YardInvType&gt; <a class="code" href="class_yard_database.html#a11">InventoryGetInGroup</a>(<span class="keywordtype">long</span> groupid) <span class="keyword">const</span>;
00134     <a class="code" href="class_yard_inv_type.html">YardInvType</a> <a class="code" href="class_yard_database.html#a12">InventoryGet</a>(<span class="keywordtype">long</span> key) <span class="keyword">const</span>;
00137     <span class="keywordtype">void</span> <a class="code" href="class_yard_database.html#a13">InventoryUpdate</a>(<span class="keyword">const</span> <a class="code" href="class_yard_inv_type.html">YardInvType</a>&amp; inv);
00138     
00142     <span class="keywordtype">long</span> <a class="code" href="class_yard_database.html#a14">InventoryAdd</a>(<span class="keyword">const</span> <a class="code" href="class_yard_inv_type.html">YardInvType</a>&amp; item);
00143     
00144     <span class="comment">/*-----------Customers----------------*/</span>
00145 
00147     <span class="keywordtype">long</span> <a class="code" href="class_yard_database.html#a15">CustomerAdd</a>(<span class="keyword">const</span> YardCustType&amp; newCust);
00149     vector&lt;YardCustType&gt; <a class="code" href="class_yard_database.html#a16">CustomerGetAll</a>();
00150     
00153     vector&lt;YardCustType&gt; <a class="code" href="class_yard_database.html#a17">CustomerSearch</a>(<span class="keyword">const</span> YardCustType&amp; criteria);
00155     <span class="keywordtype">void</span> <a class="code" href="class_yard_database.html#a18">CustomerDisable</a>(<span class="keywordtype">long</span> key);
00157     YardCustType <a class="code" href="class_yard_database.html#a19">CustomerGet</a>(<span class="keywordtype">long</span> key);
00158     
00160     <span class="keywordtype">void</span> <a class="code" href="class_yard_database.html#a20">CustomerUpdate</a>(<span class="keyword">const</span> YardCustType&amp; cust);
00161 
00162     <span class="comment">/*----------Employee-------------------*/</span>
00163     
00166     <span class="keywordtype">long</span> <a class="code" href="class_yard_database.html#a21">EmployeeAdd</a>(<span class="keyword">const</span> <a class="code" href="class_yard_employee_type.html">YardEmployeeType</a>&amp; employ);
00168     <span class="keywordtype">void</span> <a class="code" href="class_yard_database.html#a22">EmployeeDisable</a>(<span class="keywordtype">long</span> key);
00170     <a class="code" href="class_yard_employee_type.html">YardEmployeeType</a> <a class="code" href="class_yard_database.html#a23">EmployeeGet</a>(<span class="keywordtype">long</span> key) <span class="keyword">const</span>;
00172     <span class="keywordtype">void</span> <a class="code" href="class_yard_database.html#a24">EmployeeUpdate</a>(<span class="keyword">const</span> <a class="code" href="class_yard_employee_type.html">YardEmployeeType</a>&amp; employ);
00174     vector&lt;YardEmployeeType&gt; <a class="code" href="class_yard_database.html#a25">EmployeeGetAll</a>() <span class="keyword">const</span>;
00175     
00176     <span class="comment">/*----------Vendors--------------------*/</span>
00177     
00179     vector&lt;YardVendType&gt; <a class="code" href="class_yard_database.html#a26">VendorGetAll</a>() <span class="keyword">const</span>;
00180     <a class="code" href="class_yard_vend_type.html">YardVendType</a> VendorGet(<span class="keywordtype">long</span> key) <span class="keyword">const</span>;
00181     
00182     <span class="keywordtype">long</span> VendorAdd(<span class="keyword">const</span> <a class="code" href="class_yard_vend_type.html">YardVendType</a>&amp; vendor);
00183     
00184     <span class="comment">/*--------Carrier-------------------*/</span>
00185     
00187     vector&lt;YardCarrierType&gt; <a class="code" href="class_yard_database.html#a29">CarrierGetAll</a>() <span class="keyword">const</span>;
00188     <a class="code" href="class_yard_carrier_type.html">YardCarrierType</a> CarrierGet(<span class="keywordtype">long</span> key) <span class="keyword">const</span>;
00189     <span class="keywordtype">long</span> CarrierAdd(<span class="keyword">const</span> <a class="code" href="class_yard_carrier_type.html">YardCarrierType</a>&amp; carrier);
00190     vector&lt;YardShipType&gt; CarrierGetShippingTypes(<span class="keywordtype">long</span> carrierId) <span class="keyword">const</span>;
00191     <span class="keywordtype">void</span> CarrierAddShippingType(<span class="keywordtype">long</span> carrierId, <span class="keyword">const</span> <a class="code" href="class_yard_ship_type.html">YardShipType</a>&amp; shiptype);    
00192     <span class="keywordtype">void</span> CarrierDisableShippingType(<span class="keywordtype">long</span> carrierId, <span class="keywordtype">int</span> shipId);
00193     
00194     <span class="comment">/*---------Transaction----------------*/</span>
00195     
00198     <span class="keywordtype">void</span> <a class="code" href="class_yard_database.html#a35">TransactionAdd</a>(<span class="keyword">const</span> vector&lt;YardTransType&gt;&amp; transaction);
00199     vector&lt;YardTransType&gt; TransactionGet(<span class="keywordtype">long</span> transactionId) <span class="keyword">const</span>;
00200     
00203     vector&lt;long&gt; <a class="code" href="class_yard_database.html#a37">TransactionSearch</a>(<span class="keywordtype">int</span> employeeId, <span class="keywordtype">int</span> custId, <span class="keywordtype">int</span> inventoryItem) <span class="keyword">const</span>;
00204     
00205     <span class="comment">/*--------Tax Types-----------------*/</span>
00206     
00208     vector&lt;YardTaxType&gt; <a class="code" href="class_yard_database.html#a38">TaxTypeGetAll</a>() <span class="keyword">const</span>;
00209     <span class="keywordtype">long</span> TaxTypeAdd(<span class="keyword">const</span> YardTaxType&amp; taxtype);
00210     <span class="keywordtype">void</span> TaxTypeUpdate(<span class="keyword">const</span> YardTaxType&amp; taxtype);
00211     YardTaxType TaxTypeGet(<span class="keywordtype">long</span> key) <span class="keyword">const</span>;
00212     
00213     
00214     <span class="comment">/*-------Group Type----------------*/</span>
00215     
00217     vector&lt;YardGroup&gt; <a class="code" href="class_yard_database.html#a42">GroupGetAll</a>() <span class="keyword">const</span>;
00218     YardGroup GroupGet(<span class="keywordtype">long</span> key) <span class="keyword">const</span>;
00219     <span class="keywordtype">long</span> GroupAdd(<span class="keyword">const</span> YardGroup&amp; group);
00220         
00221         
00222     <span class="comment">/*---------ACLs--------------------*/</span>
00225     map&lt;string,string&gt; <a class="code" href="class_yard_database.html#a45">ACLGetAll</a>() <span class="keyword">const</span>;
00226     <span class="keywordtype">void</span> ACLAdd(<span class="keyword">const</span> string&amp; name, <span class="keyword">const</span> string&amp; desc);
00227     string ACLGet(<span class="keyword">const</span> string&amp; name); 
00228 
00229 
00230     <span class="comment">/*-----------Reports--------------*/</span>
00231     
00233     string <a class="code" href="class_yard_database.html#a48">ReportXML</a>(<span class="keyword">const</span> string&amp; sql, <span class="keywordtype">long</span>&amp; count) <span class="keyword">const</span>;
00234     
00235     
00236     <span class="comment">/*----------GENERIC---------------*/</span>
00237     
00238     <span class="keywordtype">void</span> GenericUpdate(<span class="keyword">const</span> string&amp; table, <span class="keyword">const</span> string&amp; values);
00239     <span class="keywordtype">void</span> GenericInsert(<span class="keyword">const</span> string&amp; table, <span class="keyword">const</span> string&amp; value);
00240         
00241     <span class="comment">/* helpers */</span>
00242     <span class="keyword">static</span> string tab(<span class="keywordtype">int</span> level);
00243     <span class="keyword">static</span> string escape(<span class="keyword">const</span> string&amp; esc);
00246     string <a class="code" href="class_yard_database.html#a51">ToXML</a>(otl_stream * stream, <span class="keyword">const</span> string&amp; record) <span class="keyword">const</span>;
00247     
00248  <span class="keyword">private</span>:
00249 
00251     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
00252     vector&lt;T&gt; XMLFromStream(otl_stream * stream, <span class="keyword">const</span> string&amp; table)<span class="keyword"> const </span>{
00253         vector&lt;T&gt; list;
00254         
00255         <span class="keywordflow">while</span> (!stream-&gt;eof()){
00256             T temp(<a class="code" href="class_yard_database.html#a51">ToXML</a>(stream, table));            
00257             list.push_back(temp);
00258         }
00259         
00260         <span class="keywordflow">return</span> list;
00261     }     
00262 
00264     <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;
00265     T XMLFromStreamSingle(otl_stream * stream, <span class="keyword">const</span> string&amp; table)<span class="keyword"> const </span>{
00266         T temp(<a class="code" href="class_yard_database.html#a51">ToXML</a>(stream, table));
00267         <span class="keywordflow">return</span> temp;
00268     }      
00269  
00270     otl_connect * m_db;
00271     string m_dsn;
00272     string m_name;
00273     string m_pass;
00274     <span class="comment">//otl_stream * m_invGetStream;</span>
00275      
00276 };
00277 
00278 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun May 9 23:07:58 2004 for YardSale by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
