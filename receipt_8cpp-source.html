<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>YardSale: receipt.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>receipt.cpp</h1><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;iostream&gt;</span>
00002 <span class="preprocessor">#include "receipt.h"</span>
00003 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00004 
<a name="l00006"></a><a class="code" href="class_receipt.html#a0">00006</a> <a class="code" href="class_receipt.html#a1">Receipt::Receipt</a>(<span class="keyword">const</span> string&amp; port): outport(port)
00007 {
00008     tm = <span class="keyword">new</span> ofstream(outport.c_str(), ios::out );
00009     <span class="comment">//*tm &lt;&lt; EP_cutpaper;</span>
00010     <a class="code" href="class_receipt.html#a13">EP_initialize</a>();
00011     <span class="comment">//this-&gt;EP_jcenter();</span>
00012     header = <span class="stringliteral">"AS Logic Systems\n Thank you for your business!"</span>;
00013     <span class="comment">//*tm &lt;&lt; header &lt;&lt; endl;</span>
00014     <span class="comment">//this-&gt;EP_jleft();</span>
00015     <a class="code" href="class_receipt.html#a11">printheader</a>();
00016     <span class="comment">//*tm &lt;&lt; EP_initialize &lt;&lt; header &lt;&lt; EP_jleft;</span>
00017 }
00018 
<a name="l00020"></a><a class="code" href="class_receipt.html#a1">00020</a> <a class="code" href="class_receipt.html#a1">Receipt::Receipt</a>()
00021 {
00022     tm = 0;
00023 }
00024 
<a name="l00026"></a><a class="code" href="class_receipt.html#a2">00026</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a2">Receipt::Init</a>(<span class="keyword">const</span> string&amp; port)
00027 {
00028     <span class="keywordflow">if</span> (tm) 
00029         <span class="keywordflow">return</span>; <span class="comment">// if already initialized, dont do it again</span>
00030     <span class="keywordflow">if</span> (port == <span class="stringliteral">""</span>)
00031         <span class="keywordflow">return</span>;
00032     
00033     tm = <span class="keyword">new</span> ofstream(port.c_str(), ios::out);
00034     <a class="code" href="class_receipt.html#a13">EP_initialize</a>();
00035     <span class="comment">//this-&gt;EP_jcenter();</span>
00036     header = <span class="stringliteral">"AS Logic Systems\n Thank you for your business!"</span>;
00037     <span class="comment">//*tm &lt;&lt; header &lt;&lt; endl;</span>
00038     <span class="comment">//this-&gt;EP_jleft();</span>
00039     <a class="code" href="class_receipt.html#a11">printheader</a>();  
00040 }
00041 
00042 <span class="comment">/*</span>
00043 <span class="comment"> * It's that "I just turned on my computer and started</span>
00044 <span class="comment"> * YardSale" feeling, any time of the day you want it.</span>
00045 <span class="comment"> */</span>
00046 
<a name="l00049"></a><a class="code" href="class_receipt.html#a5">00049</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a5">Receipt::reset</a>(){
00050     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00051     colist.clear();
00052     <a class="code" href="class_receipt.html#a13">EP_initialize</a>();
00053     <a class="code" href="class_receipt.html#a11">printheader</a>();
00054 }
00055 
00056 <span class="comment">/*</span>
00057 <span class="comment"> * This calls additem on an array of my fictional RTransType</span>
00058 <span class="comment"> * objects.  WHOOPEE!</span>
00059 <span class="comment"> */</span>
00060 
<a name="l00062"></a><a class="code" href="class_receipt.html#a6">00062</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a6">Receipt::addTlist</a>(vector &lt;RTransType&gt; tlist){
00063     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; tlist.size(); ii++)
00064         <a class="code" href="class_receipt.html#a7">additem</a>(tlist[ii].item, tlist[ii].price);
00065 }
00066 
00067 <span class="comment">/*</span>
00068 <span class="comment"> * Receipt::additem creates a vector of formatted strings</span>
00069 <span class="comment"> * containing the item name and price, chopped up to fit in</span>
00070 <span class="comment"> * 40 columns (42 actually).  There is probably a better way</span>
00071 <span class="comment"> * to do this.</span>
00072 <span class="comment"> */</span>
00073 
<a name="l00075"></a><a class="code" href="class_receipt.html#a7">00075</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a7">Receipt::additem</a>(<span class="keyword">const</span> string&amp; item, <span class="keyword">const</span> string&amp; price){
00076     string nitem = item.substr(0, 31);
00077     <span class="keywordflow">if</span> (item.length() &lt; 33) {
00078         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 32 - item.length(); ii++) {
00079             nitem += <span class="stringliteral">" "</span>;
00080         }
00081     }
00082     nitem += <span class="stringliteral">"$"</span> + price;
00083     colist.push_back(nitem);
00084 }
00085 
00086 <span class="comment">/*</span>
00087 <span class="comment"> * U R St00pid if you don't know what this does.</span>
00088 <span class="comment"> */</span>
00089 
<a name="l00091"></a><a class="code" href="class_receipt.html#a8">00091</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a8">Receipt::totdata</a>(<span class="keyword">const</span> string&amp; total, <span class="keyword">const</span> string&amp; ttx, <span class="keyword">const</span> string&amp; taxtotal){
00092     tot = total;
00093     tax = ttx;
00094     tottax = taxtotal;
00095 }
00096 
<a name="l00098"></a><a class="code" href="class_receipt.html#a9">00098</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a9">Receipt::change</a>(<span class="keyword">const</span> string&amp; type, <span class="keyword">const</span> string&amp; tender, <span class="keyword">const</span> string&amp; change)
00099 {
00100     m_type = type;
00101     m_tender = tender;
00102     m_change = change;
00103     
00104 }
00105 
00106 <span class="comment">/*</span>
00107 <span class="comment"> * This iterates through the checkout list and prints the data</span>
00108 <span class="comment"> * in it, along with the subtotal, tax, and total for the current</span>
00109 <span class="comment"> * transaction.  It then prints a header and a few newlines and</span>
00110 <span class="comment"> * chops the receipt off right above the new header (I'm saving</span>
00111 <span class="comment"> * paper!)</span>
00112 <span class="comment"> */</span>
00113 
<a name="l00116"></a><a class="code" href="class_receipt.html#a10">00116</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a10">Receipt::print</a>(){
00117     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00118     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = 0; ii &lt; colist.size(); ii++)
00119         *tm &lt;&lt; colist[ii] &lt;&lt; endl;
00120     *tm &lt;&lt; <span class="stringliteral">"SUBTOTAL:          $"</span> &lt;&lt; tot &lt;&lt; endl;
00121     *tm &lt;&lt; <span class="stringliteral">"TAX:               $"</span> &lt;&lt; tax &lt;&lt; endl;
00122     *tm &lt;&lt; <span class="stringliteral">"TOTAL:             $"</span> &lt;&lt; tottax &lt;&lt; endl &lt;&lt; endl;
00123     <span class="keywordflow">if</span> (m_type != <span class="stringliteral">""</span>)
00124     {
00125         *tm &lt;&lt; m_type &lt;&lt; <span class="stringliteral">"               $"</span> &lt;&lt; m_tender &lt;&lt; endl;
00126         *tm &lt;&lt; <span class="stringliteral">"CHANGE:             $"</span> &lt;&lt; m_change &lt;&lt; endl;
00127     }
00128     
00129 <span class="comment">//  this-&gt;EP_initialize();</span>
00130 <span class="comment">//  *tm &lt;&lt; "\n\n";</span>
00131     <a class="code" href="class_receipt.html#a11">printheader</a>();
00132     <a class="code" href="class_receipt.html#a14">EP_cutpaper</a>();
00133     *tm &lt;&lt; endl;
00134     <span class="comment">//this-&gt;EP_pboth();</span>
00135 }
00136 
00137 <span class="comment">/*</span>
00138 <span class="comment"> * centers the printing, prints the header string, and </span>
00139 <span class="comment"> * returns the printing to left justification.</span>
00140 <span class="comment"> */</span>
00141 
<a name="l00143"></a><a class="code" href="class_receipt.html#a11">00143</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a11">Receipt::printheader</a>(){
00144     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00145     <a class="code" href="class_receipt.html#a19">EP_jcenter</a>();
00146     *tm &lt;&lt; endl &lt;&lt; endl &lt;&lt; header &lt;&lt; endl;
00147     <a class="code" href="class_receipt.html#a18">EP_jleft</a>();
00148 }
00149 
00150 <span class="comment">/*</span>
00151 <span class="comment"> * ???</span>
00152 <span class="comment"> */</span>
00153 
<a name="l00155"></a><a class="code" href="class_receipt.html#a12">00155</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a12">Receipt::test</a>() {
00156     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00157     <span class="keywordtype">char</span> <a class="code" href="class_receipt.html#a12">test</a>[] = { 0x00, 0x00, 0x61 };
00158     *tm &lt;&lt; test &lt;&lt; <span class="stringliteral">"\n\n\n\n\n"</span>;
00159 }
00160 
00161 <span class="comment">/*</span>
00162 <span class="comment"> * This batch of code-herpes is necessary because it's the</span>
00163 <span class="comment"> * easiest way I know of right now to predefine strings that</span>
00164 <span class="comment"> * contain the NULL byte.  Hah.</span>
00165 <span class="comment"> */</span>
00166 
<a name="l00168"></a><a class="code" href="class_receipt.html#a13">00168</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a13">Receipt::EP_initialize</a>(){
00169     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00170     *tm &lt;&lt; '\x1b' &lt;&lt; '\x40';
00171 }
00172 
<a name="l00174"></a><a class="code" href="class_receipt.html#a14">00174</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a14">Receipt::EP_cutpaper</a>(){
00175     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00176     *tm &lt;&lt; '\x1d' &lt;&lt; '\x56' &lt;&lt; '\x01' &lt;&lt; endl;
00177 }
00178 
<a name="l00180"></a><a class="code" href="class_receipt.html#a15">00180</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a15">Receipt::EP_ppole</a>(){
00181     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00182     *tm &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x02';
00183 }
00184 
<a name="l00186"></a><a class="code" href="class_receipt.html#a16">00186</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a16">Receipt::EP_pprinter</a>(){
00187     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00188     *tm &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x01';
00189 }
00190 
<a name="l00192"></a><a class="code" href="class_receipt.html#a17">00192</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a17">Receipt::EP_pboth</a>(){
00193     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00194     *tm &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x03';
00195 }
00196 
<a name="l00198"></a><a class="code" href="class_receipt.html#a18">00198</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a18">Receipt::EP_jleft</a>(){
00199     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00200     *tm &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x00';
00201 }
00202 
<a name="l00204"></a><a class="code" href="class_receipt.html#a19">00204</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a19">Receipt::EP_jcenter</a>(){
00205     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00206     *tm &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x01';
00207 }
00208 
<a name="l00210"></a><a class="code" href="class_receipt.html#a20">00210</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a20">Receipt::EP_jright</a>(){
00211     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00212     *tm &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x02';
00213 }
00214 
<a name="l00216"></a><a class="code" href="class_receipt.html#a21">00216</a> <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a21">Receipt::EP_dkd</a>(){ <span class="comment">//kicks out cash drizzawer</span>
00217     <span class="keywordflow">if</span> (!tm) <span class="keywordflow">return</span>;
00218     *tm &lt;&lt; '\x1b' &lt;&lt; <span class="charliteral">'p'</span> &lt;&lt; '\x00' &lt;&lt; '\x64' &lt;&lt; '\x64';
00219 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun May 9 23:07:57 2004 for YardSale by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
