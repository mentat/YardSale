<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>YardSale: receipt_new.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>receipt_new.cpp</h1><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;iostream&gt;</span>
00002 <span class="preprocessor">#include "receipt.h"</span>
00003 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00004 
00005 <a class="code" href="class_receipt.html#a1">Receipt::Receipt</a>(<span class="keyword">const</span> string&amp; port): outport(port)
00006 {
00007     tm = <span class="keyword">new</span> ofstream(outport.c_str(), ios::out );
00008     header = <span class="stringliteral">"AS Logic\n Selling you free shit\n since right about now."</span>;
00009     
00010     ptype = YSPESCPOS;
00011     <span class="keywordflow">if</span> ( ptype == YSPSTAR ) {
00012         pcodes = <span class="keyword">new</span> ysSRPCodes(*tm, header);
00013     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ptype == YSPESCPOS ) {
00014         pcodes = <span class="keyword">new</span> ysEPRPCodes(*tm, header);
00015     } <span class="keywordflow">else</span> {
00016         pcodes = <span class="keyword">new</span> ysGenRPCodes(*tm, header);
00017     }
00018     
00019     <span class="comment">//EP_initialize();</span>
00020     pcodes.initialize();
00021     pcodes.printheader();
00022 }
00023 
00024 <span class="comment">/*</span>
00025 <span class="comment"> * It's that "I just turned on my computer and started</span>
00026 <span class="comment"> * YardSale" feeling, any time of the day you want it.</span>
00027 <span class="comment"> */</span>
00028 <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a5">Receipt::reset</a>(){
00029     colist.clear();
00030     pcodes.initialize();
00031     pcodes.printheader();
00032 }
00033 
00034 <span class="comment">/*</span>
00035 <span class="comment"> * This calls additem on an array of my fictional RTransType</span>
00036 <span class="comment"> * objects.  WHOOPEE!</span>
00037 <span class="comment"> */</span>
00038 <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a6">Receipt::addTlist</a>(vector &lt;RTransType&gt; tlist){
00039     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; tlist.size(); ii++)
00040         <a class="code" href="class_receipt.html#a7">additem</a>(tlist[ii].item, tlist[ii].price);
00041 }
00042 
00043 <span class="comment">/*</span>
00044 <span class="comment"> * Receipt::additem creates a vector of formatted strings</span>
00045 <span class="comment"> * containing the item name and price, chopped up to fit in</span>
00046 <span class="comment"> * 40 columns (42 actually).  There is probably a better way</span>
00047 <span class="comment"> * to do this.</span>
00048 <span class="comment"> */</span>
00049 <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a7">Receipt::additem</a>(<span class="keyword">const</span> string&amp; item, <span class="keyword">const</span> string&amp; price){
00050     string nitem = item.substr(0, 31);
00051     <span class="keywordflow">if</span> (item.length() &lt; 33) {
00052         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 32 - item.length(); ii++) {
00053             nitem += <span class="stringliteral">" "</span>;
00054         }
00055     }
00056     nitem += <span class="stringliteral">"$"</span> + price;
00057     colist.push_back(nitem);
00058 }
00059 
00060 <span class="comment">/*</span>
00061 <span class="comment"> * U R St00pid if you don't know what this does.</span>
00062 <span class="comment"> */</span>
00063 <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a8">Receipt::totdata</a>(<span class="keyword">const</span> string&amp; total, <span class="keyword">const</span> string&amp; ttx,
00064         <span class="keyword">const</span> string&amp; taxtotal){
00065     tot = total;
00066     tax = ttx;
00067     tottax = taxtotal;
00068 }
00069 
00070 <span class="comment">/*</span>
00071 <span class="comment"> * This iterates through the checkout list and prints the data</span>
00072 <span class="comment"> * in it, along with the subtotal, tax, and total for the current</span>
00073 <span class="comment"> * transaction.  It then prints a header and a few newlines and</span>
00074 <span class="comment"> * chops the receipt off right above the new header (I'm saving</span>
00075 <span class="comment"> * paper!)</span>
00076 <span class="comment"> */</span>
00077 <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a10">Receipt::print</a>(){
00078     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii = 0; ii &lt; colist.size(); ii++)
00079         *tm &lt;&lt; colist[ii] &lt;&lt; endl;
00080     *tm &lt;&lt; <span class="stringliteral">"SUBTOTAL:        $"</span> &lt;&lt; tot &lt;&lt; endl;
00081     *tm &lt;&lt; <span class="stringliteral">"TAX:             $"</span> &lt;&lt; tax &lt;&lt; endl;
00082     *tm &lt;&lt; <span class="stringliteral">"TOTAL:           $"</span> &lt;&lt; tottax &lt;&lt; endl;
00083 <span class="comment">//  this-&gt;EP_initialize();</span>
00084 <span class="comment">//  *tm &lt;&lt; "\n\n";</span>
00085     <span class="comment">//printheader();</span>
00086     <span class="comment">//EP_cutpaper();</span>
00087     <span class="comment">//pcodes.cutpaper();</span>
00088     pcodes.finishreceipt();
00089     *tm &lt;&lt; endl;
00090     <span class="comment">//this-&gt;EP_pboth();</span>
00091 }
00092 
00093 <span class="comment">/*</span>
00094 <span class="comment"> * centers the printing, prints the header string, and </span>
00095 <span class="comment"> * returns the printing to left justification.</span>
00096 <span class="comment"> */</span>
00097 <span class="comment">/* void Receipt::printheader(){</span>
00098 <span class="comment">    EP_jcenter();</span>
00099 <span class="comment">    *tm &lt;&lt; endl &lt;&lt; endl &lt;&lt; header &lt;&lt; endl;</span>
00100 <span class="comment">    EP_jleft();</span>
00101 <span class="comment">} </span>
00102 <span class="comment">*/</span>
00103 
00104 <span class="comment">/*</span>
00105 <span class="comment"> * ???</span>
00106 <span class="comment"> */</span>
00107 <span class="keywordtype">void</span> <a class="code" href="class_receipt.html#a12">Receipt::test</a>() {
00108     <span class="keywordtype">char</span> <a class="code" href="class_receipt.html#a12">test</a>[] = { 0x00, 0x00, 0x61 };
00109     *tm &lt;&lt; test &lt;&lt; <span class="stringliteral">"\n\n\n\n\n"</span>;
00110 }
00111 
00112 <span class="comment">/*</span>
00113 <span class="comment"> * This batch of code-herpes is necessary because it's the</span>
00114 <span class="comment"> * easiest way I know of right now to predefine strings that</span>
00115 <span class="comment"> * contain the NULL byte.  Hah.</span>
00116 <span class="comment"> */</span>
00117 <span class="comment">/*</span>
00118 <span class="comment">void Receipt::EP_initialize(){</span>
00119 <span class="comment">    *tm &lt;&lt; '\x1b' &lt;&lt; '\x40';</span>
00120 <span class="comment">}</span>
00121 <span class="comment">void Receipt::EP_cutpaper(){</span>
00122 <span class="comment">    *tm &lt;&lt; '\x1d' &lt;&lt; '\x56' &lt;&lt; '\x01' &lt;&lt; endl;</span>
00123 <span class="comment">}</span>
00124 <span class="comment">void Receipt::EP_ppole(){</span>
00125 <span class="comment">    *tm &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x02';</span>
00126 <span class="comment">}</span>
00127 <span class="comment">void Receipt::EP_pprinter(){</span>
00128 <span class="comment">    *tm &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x01';</span>
00129 <span class="comment">}</span>
00130 <span class="comment">void Receipt::EP_pboth(){</span>
00131 <span class="comment">    *tm &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x03';</span>
00132 <span class="comment">}</span>
00133 <span class="comment">void Receipt::EP_jleft(){</span>
00134 <span class="comment">    *tm &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x00';</span>
00135 <span class="comment">}</span>
00136 <span class="comment">void Receipt::EP_jcenter(){</span>
00137 <span class="comment">    *tm &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x01';</span>
00138 <span class="comment">}</span>
00139 <span class="comment">void Receipt::EP_jright(){</span>
00140 <span class="comment">    *tm &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x02';</span>
00141 <span class="comment">}</span>
00142 <span class="comment">*/</span>
00143 
00144 ysReceiptPrinterCodes::ysReceiptPrinterCodes(){
00145 }
00146 
00147 ysReceiptPrinterCodes::ysReceiptPrinterCodes(ofstream &amp;printer, 
00148         <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;ptype, <span class="keyword">const</span> string&amp; header){
00149     this-&gt;ptype = ptype;
00150     this-&gt;printer = printer;
00151     this-&gt;header = header;
00152 }
00153 
00154 <span class="keywordtype">void</span> ysReceiptPrinterCodes::justleft(){
00155 }
00156 
00157 <span class="keywordtype">void</span> ysReceiptPrinterCodes::justcenter(){
00158 }
00159 
00160 <span class="keywordtype">void</span> ysReceiptPrinterCodes::justright(){
00161 }
00162 
00163 <span class="keywordtype">void</span> ysReceiptPrinterCodes::prnpole(){
00164 }
00165 
00166 <span class="keywordtype">void</span> ysReceiptPrinterCodes::prnpaper(){
00167 }
00168 
00169 <span class="keywordtype">void</span> ysReceiptPrinterCodes::prnboth(){
00170 }
00171 
00172 <span class="keywordtype">void</span> ysReceiptPrinterCodes::cutpaper(){
00173 }
00174 
00175 <span class="keywordtype">void</span> ysReceiptPrinterCodes::initialize(){
00176 }
00177 
00178 <span class="keywordtype">void</span> ysReceiptPrinterCodes::printheader(){
00179     this-&gt;justcenter();
00180     printer &lt;&lt; endl &lt;&lt; endl &lt;&lt; header &lt;&lt; endl;
00181     this-&gt;justleft();
00182 }
00183 
00184 <span class="keywordtype">void</span> ysReceiptPrinterCodes::finishreceipt(){
00185     this-&gt;<a class="code" href="class_receipt.html#a11">printheader</a>();
00186     this-&gt;cutpaper();
00187 }
00188 
00189 <span class="keywordtype">void</span> ysEPRPCodes::justleft(){
00190     *printer &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x00';
00191 }
00192 
00193 <span class="keywordtype">void</span> ysEPRPCodes::justcenter(){
00194     *printer &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x01';
00195 }
00196 
00197 <span class="keywordtype">void</span> ysEPRPCodes::justright(){
00198     *printer &lt;&lt; '\x1b' &lt;&lt; '\x61' &lt;&lt; '\x02';
00199 }
00200 
00201 <span class="keywordtype">void</span> ysEPRPCodes::prnpole(){
00202     *printer &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x02';
00203 }
00204 
00205 <span class="keywordtype">void</span> ysEPRPCodes::prnpaper(){
00206     *printer &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x01';
00207 }
00208 
00209 <span class="keywordtype">void</span> ysEPRPCodes::prnboth(){
00210     *printer &lt;&lt; '\x1b' &lt;&lt; '\x3d' &lt;&lt; '\x03';
00211 }
00212 
00213 <span class="keywordtype">void</span> ysEPRPCodes::cutpaper(){
00214     *printer &lt;&lt; '\x1d' &lt;&lt; '\x56' &lt;&lt; '\x01' &lt;&lt; endl;
00215 }
00216 
00217 <span class="keywordtype">void</span> ysEPRPCodes::initialize(){
00218     *printer &lt;&lt; '\x1b' &lt;&lt; '\x40';
00219 }
00220 
00221 <span class="keywordtype">void</span> ysEPRPCodes::printheader(){
00222 }
00223 
00224 <span class="keywordtype">void</span> ysEPRPCodes::finishreceipt(){
00225 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun May 9 23:07:57 2004 for YardSale by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
